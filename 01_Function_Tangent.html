<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Tangent Line</title>

  <!-- GeoGebra -->
  <script src="https://www.geogebra.org/apps/deployggb.js"></script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 16px;
    }

    h3 {
      margin-bottom: 12px;
    }

    #controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 12px;
    }

    label {
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    input {
      padding: 6px 8px;
      width: 260px;
    }

    button {
      padding: 6px 12px;
      cursor: pointer;
    }

    #ggb-element {
      width: 1100px;
      height: 650px;
      max-width: 100%;
    }
  </style>
</head>

<body>

  <h3>Υπολογισμός εξίσωσης εφαπτομένης σε σημείο συνάρτησης</h3>

  <div id="controls">
    <label>
      f(x):
      <input id="fx" value="e^(x^2+x)">
    </label>

    <label>
      x₀:
      <input id="x0" value="-1">
    </label>

    <button id="apply">Υπολογισμός</button>
  </div>

  <div id="ggb-element"></div>

  <script>
    // ---------------- GeoGebra embed ----------------
    const params = {
      appName: "classic",
      filename: "01_Function_Tangent.ggb",

      width: 1100,
      height: 650,

      showToolBar: false,
      showAlgebraInput: false,
      showMenuBar: false,

      enableRightClick: false,      // stronger lock-down
      enableShiftDragZoom: true,    // allow zoom
      enableLabelDrags: false,

      showResetIcon: false,     // ← hides reset / home icon
      allowStyleBar: false,    // ← hides gear-style controls
      showZoomButtons: false,  // ← hides + / − zoom icons

      appletOnLoad(api) {
        window.ggb = api;
      }
    };

    const applet = new GGBApplet(params, true);
    window.addEventListener("load", () => {
      applet.inject("ggb-element");
    });

    // ---------------- Helpers ----------------
    function normalizeFunctionInput(fx) {
      return fx
        .replace(/\bsinx\b/gi, "sin(x)")
        .replace(/\bcosx\b/gi, "cos(x)")
        .replace(/\btanx\b/gi, "tan(x)");
    }

    // ---------------- Update logic ----------------
    function updateFromInputs() {
      if (!window.ggb) return;

      const fx = normalizeFunctionInput(
        document.getElementById("fx").value.trim()
      );

      const x0 = document.getElementById("x0").value.trim();

      try {
        ggb.evalCommand(`f(x) = ${fx}`);
        ggb.evalCommand(`x0 = ${x0}`);
      } catch (e) {
        // silently ignore invalid input
      }
    }

    // ---------------- UI events ----------------
    document.getElementById("apply")
      .addEventListener("click", updateFromInputs);

    document.getElementById("fx")
      .addEventListener("keydown", e => {
        if (e.key === "Enter") updateFromInputs();
      });

    document.getElementById("x0")
      .addEventListener("keydown", e => {
        if (e.key === "Enter") updateFromInputs();
      });
  </script>

</body>
</html>
